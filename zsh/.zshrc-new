export ZDOTDIR="$HOME/.config/zsh"

# -----------------------------------------------------------------------------
# ********************************* Plugins ***********************************
# -----------------------------------------------------------------------------

autoload -Uz compinit; compinit

source $ZDOTDIR/plugins/fzf-tab/fzf-tab.plugin.zsh
source $ZDOTDIR/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh
source $ZDOTDIR/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh


# -----------------------------------------------------------------------------
# ********************************* Aliases ***********************************
# -----------------------------------------------------------------------------

source $ZDOTDIR/zsh-aliases


# -----------------------------------------------------------------------------
# ********************************* History ***********************************
# -----------------------------------------------------------------------------

export HISTFILE="$ZDOTDIR/.zhistory"
export HISTSIZE=10000
export SAVEHIST=10000

setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_FIND_NO_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_SAVE_NO_DUPS
setopt INC_APPEND_HISTORY

# Sift through history matching up to current cursor position
autoload -U up-line-or-beginning-search
autoload -U down-line-or-beginning-search

# Moves the cursor to the end of line after each match
zle -N up-line-or-beginning-search
zle -N down-line-or-beginning-search


# -----------------------------------------------------------------------------
# ****************************** Key bindings *********************************
# -----------------------------------------------------------------------------

bindkey "^[[1;3A" beginning-of-line # Option + ARROW_UP
bindkey "^[[1;3B" end-of-line # Option + ARROW_DOWN
bindkey "^[[1;3C" forward-word # Option + ARROW_RIGHT - move cursor forward one word
bindkey "^[[1;3D" backward-word # Option + ARROW_LEFT - move cursor backward one word

bindkey "^Z" undo # CTRL+Z
bindkey "^Y" redo # CTRL+Y

bindkey "^[[A" up-line-or-beginning-search # ARROW_UP
bindkey "^[[B" down-line-or-beginning-search # ARROW_DOWN


# -----------------------------------------------------------------------------
# *********************************** Prompt **********************************
# -----------------------------------------------------------------------------

# VCS info
autoload -Uz vcs_info

zstyle ':vcs_info:git*' enable git
zstyle ':vcs_info:git*' check-for-changes true
zstyle ':vcs_info:git*' formats "%F{yellow}%f %F{blue}%b%f %m%u%c %a"
zstyle ':vcs_info:*' stagedstr " %F{green}✚%f"
zstyle ':vcs_info:*' unstagedstr " %F{red}●%f"

setopt PROMPT_SUBST

precmd() {
    vcs_info
    print -P '\n%F{8}%~%f ${vcs_info_msg_0_}'
}

# Prompt
PROMPT='%B%(!.#.$)%b '

# Error prompt
RPROMPT='%F{red}%(0?||Error: %?)%f'


# -----------------------------------------------------------------------------
# ************************************ Misc ***********************************
# -----------------------------------------------------------------------------

# Default editor 
if [[ -n $SSH_CONNECTION ]]; then
  export EDITOR='vim'
else
  export EDITOR='nvim'
fi

# change directories by simply typing the directory name without "cd" 
setopt autocd

# fzf
source /opt/homebrew/opt/fzf/shell/key-bindings.zsh
source /opt/homebrew/opt/fzf/shell/completion.zsh

# homebrew - for adding brew and packages added via brew to $PATH
eval "$(/opt/homebrew/bin/brew shellenv)"

